{% extends "base.html" %}
{% block title %}Leads – Admin{% endblock %}

{% block content %}
<div class="max-w-5xl mx-auto py-8">
  <h1 class="text-2xl font-semibold mb-4">Leads</h1>

  <div class="overflow-x-auto bg-white border rounded">
    <table class="min-w-full text-sm">
      <thead class="bg-gray-100">
        <tr>
          <th class="px-3 py-2 text-left">Created</th>
          <th class="px-3 py-2 text-left">Listing</th>
          <th class="px-3 py-2 text-left">Buyer</th>
          <th class="px-3 py-2 text-left">Status</th>
          <th class="px-3 py-2 text-left">Message</th>
        </tr>
      </thead>
      <tbody>
        {% for lead in leads %}
          <tr class="border-t">
            <td class="px-3 py-2 whitespace-nowrap">
              {{ lead.created_at.strftime("%Y-%m-%d %H:%M") }}
            </td>
            <td class="px-3 py-2">
              #{{ lead.listing_id }}
              {% if lead.listing %}
                – <a href="{{ url_for('listing_detail', listing_id=lead.listing.id) }}" class="text-blue-600 hover:underline">
                  {{ lead.listing.name }}
                </a>
              {% endif %}
            </td>
            <td class="px-3 py-2">
              <div class="font-medium">{{ lead.buyer_name }}</div>
              <div class="text-gray-600">{{ lead.buyer_email }}</div>
              {% if lead.buyer_phone %}
                <div class="text-gray-600">{{ lead.buyer_phone }}</div>
              {% endif %}
            </td>
            <td class="px-3 py-2">
              <span class="inline-flex items-center px-2 py-1 rounded text-xs
                {% if lead.status == 'new' %}bg-green-100 text-green-800
                {% elif lead.status == 'in_progress' %}bg-yellow-100 text-yellow-800
                {% else %}bg-gray-100 text-gray-800{% endif %}">
                {{ lead.status|capitalize }}
              </span>
            </td>
            <td class="px-3 py-2 max-w-md">
              <div class="text-gray-800 line-clamp-3">
                {{ lead.message }}
              </div>
            </td>
          </tr>
        {% else %}
          <tr>
            <td colspan="5" class="px-3 py-4 text-center text-gray-500">
              No leads yet.
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}
